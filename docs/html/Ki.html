<html>
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Ki docs: Ki</title>
    <style type="text/css">
      a { text-decoration: none; }
      a:hover { text-decoration: underline; }
      th { background-color: #DDDDDD; vertical-align: top; padding: 3px; }
      td { width: 100%; background-color: #EEEEEE; vertical-align: top; padding: 3px; }
      table { width: 100% ; border: 1px solid #0; text-align: left; }
      section > table table td { width: 0; }
    </style>
    <link rel="stylesheet" href="docs.css" type="text/css" media="screen" />
  </head>
  <body>
    <header>
      <h1><a href="./index.html">docs</a> &raquo; Ki</h1>
      <blockquote><p>A proof of concept to apply the <a href="https://stackoverflow.com/questions/1218390/what-is-your-most-productive-shortcut-with-vim/1220118#1220118">"Zen" of vi</a> to desktop automation.</p>
</blockquote>
<h3>Intro</h3>
<p>Ki follows a <a href="http://vimcasts.org/episodes/modal-editing-undo-redo-and-repeat">modal paradigm</a>: as you would edit text objects with operators in vi, you would automate entities with actions in Ki.</p>
<p>Ki provides an API for configuring custom modes and keyboard shortcuts to allow for the automation of any "entity", such as applications, files, websites, windows, smart devices, basically anything that can be programmatically controlled on macOS.</p>
<p>Ki ships with the following core modes:</p>
<ul>
<li><code>DESKTOP</code> the default state of macOS</li>
<li><code>NORMAL</code> a mode in which modes can be entered or actions can be specified</li>
<li><code>ENTITY</code> a mode in which entities are available to be launched or activated</li>
</ul>

      </header>
      <h3>API Overview</h3>
      <ul>
        <li>Constants - Useful values which cannot be changed</li>
          <ul>
            <li><a href="#Application">Application</a></li>
            <li><a href="#Entity">Entity</a></li>
            <li><a href="#File">File</a></li>
            <li><a href="#SmartFolder">SmartFolder</a></li>
            <li><a href="#state">state</a></li>
            <li><a href="#URL">URL</a></li>
          </ul>
        <li>Variables - Configurable values</li>
          <ul>
            <li><a href="#defaultEntities">defaultEntities</a></li>
            <li><a href="#statusDisplay">statusDisplay</a></li>
          </ul>
        <li>Methods - API calls which can only be made on an object returned by a constructor</li>
          <ul>
            <li><a href="#registerModes">registerModes</a></li>
            <li><a href="#registerShortcuts">registerShortcuts</a></li>
            <li><a href="#start">start</a></li>
            <li><a href="#stop">stop</a></li>
            <li><a href="#useDefaultConfig">useDefaultConfig</a></li>
          </ul>
      </ul>
      <h3>API Documentation</h3>
        <h4 class="documentation-section">Constants</h4>
          <section id="Application">
            <a name="//apple_ref/cpp/Constant/Application" class="dashAnchor"></a>
            <h5><a href="#Application">Application</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.Application</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A <a href="https://github.com/kikito/middleclass/wiki">middleclass</a> class that subclasses <a href="Entity.html">Entity</a> to represent some automatable desktop application. Class methods and properties are documented <a href="Application.html">here</a>.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="Entity">
            <a name="//apple_ref/cpp/Constant/Entity" class="dashAnchor"></a>
            <h5><a href="#Entity">Entity</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.Entity</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A <a href="https://github.com/kikito/middleclass/wiki">middleclass</a> class that represents some generic automatable desktop entity. Class methods and properties are documented <a href="Entity.html">here</a>.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="File">
            <a name="//apple_ref/cpp/Constant/File" class="dashAnchor"></a>
            <h5><a href="#File">File</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.File</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A <a href="https://github.com/kikito/middleclass/wiki">middleclass</a> class that represents some file or directory at an existing file path. Class methods and properties are documented <a href="File.html">here</a>.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="SmartFolder">
            <a name="//apple_ref/cpp/Constant/SmartFolder" class="dashAnchor"></a>
            <h5><a href="#SmartFolder">SmartFolder</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.SmartFolder</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A <a href="https://github.com/kikito/middleclass/wiki">middleclass</a> class that represents some <a href="https://support.apple.com/kb/PH25589">smart folder</a> at an existing file path. Class methods and properties are documented <a href="SmartFolder.html">here</a>.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="state">
            <a name="//apple_ref/cpp/Constant/state" class="dashAnchor"></a>
            <h5><a href="#state">state</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.state</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>The <a href="https://github.com/unindented/lua-fsm#usage">finite state machine</a> used to manage modes in Ki.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="URL">
            <a name="//apple_ref/cpp/Constant/URL" class="dashAnchor"></a>
            <h5><a href="#URL">URL</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.URL</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Constant</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A <a href="https://github.com/kikito/middleclass/wiki">middleclass</a> class that represents some url. Class methods and properties are documented <a href="URL.html">here</a>.</p>
</td>
              </tr>
            </table>
          </section>
        <h4 class="documentation-section">Variables</h4>
          <section id="defaultEntities">
            <a name="//apple_ref/cpp/Variable/defaultEntities" class="dashAnchor"></a>
            <h5><a href="#defaultEntities">defaultEntities</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.defaultEntities</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Variable</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A table containing lists of all default entity instances keyed by mode name when the <a href="#useDefaultConfig">default config</a> is used, <code>nil</code> otherwise.</p>
</td>
              </tr>
            </table>
          </section>
          <section id="statusDisplay">
            <a name="//apple_ref/cpp/Variable/statusDisplay" class="dashAnchor"></a>
            <h5><a href="#statusDisplay">statusDisplay</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki.statusDisplay</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Variable</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>A table that defines the behavior for displaying the status of mode transitions. The <code>show</code> function should clear out any previous display and show the current transitioned mode. The following methods should be available on the object:</p>
<ul>
<li><code>show</code> - A function invoked when a mode transition event occurs, with the following arguments:<ul>
<li><code>status</code> - A string value containing the current mode</li>
<li><code>action</code> - An action specified in the current active workflow, <code>nil</code> otherwise</li>
</ul>
</li>
</ul>
<p>Defaults to a simple text display in the center of the menu bar of the focused screen.</p>
</td>
              </tr>
            </table>
          </section>
        <h4 class="documentation-section">Methods</h4>
          <section id="registerModes">
            <a name="//apple_ref/cpp/Method/registerModes" class="dashAnchor"></a>
            <h5><a href="#registerModes">registerModes</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki:registerModes(stateTransitions, transitionShortcuts) -&gt; table of state transition events, table of transition shortcuts</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Method</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>Registers state events that transition between modes and their assigned keyboard shortcuts.</p>
<p>Parameters:</p>
<ul>
<li><p><code>stateTransitions</code> - A table containing the <a href="https://github.com/unindented/lua-fsm#usage">state transition events</a> for the finite state machine set to <a href="#state"><code>Ki.state</code></a>.</p>
<p>The example state events below create methods on <code>Ki.state</code> to enter and exit entity mode from normal mode:</p>

<pre><code> { { name = "enterEntityMode", from = "normal", to = "entity" }
   { name = "exitMode", from = "entity", to = "normal" } }</code></pre>
<p><strong>Note</strong>: these events will only <em>initialize and expose</em> methods on <a href="#state"><code>Ki.state</code></a>. For example, the <code>Ki.state:enterEntityMode</code> and <code>Ki.state:exitMode</code> methods will only be <em>initialized</em> with the example state events above, in which they can be used in the handler functions for the <code>transitionShortcuts</code> in the second argument.</p>
</li>
<li><p><code>transitionShortcuts</code> - Lists of shortcut objects keyed by mode name, with each shortcut allowing the transition from and to the modes specified in the <code>stateTransitions</code> events.</p>
<p>Continuing with the example above, we can reference the <code>Ki.state:enterEntityMode</code> and <code>Ki.state:exitMode</code> methods initialized by the state transitions to define the shortcuts that enter and exit entity mode:</p>

<pre><code> {
     -- For when in `normal` mode
     normal = {
         -- Register &lt;cmd&gt; + e as the shortcut to enter `entity` mode
         { {"cmd"}, "e", function() Ki.state:enterEntityMode() end, { "Normal Mode", "Transition to Entity Mode" } },
     },
     -- For when in `entity` mode
     entity = {
         -- Register &lt;escape&gt; as the shortcut to exit back to `desktop` mode
         { nil, "escape", function() Ki.state:exitMode() end, { "Entity Mode", "Exit to Desktop Mode" } },
     },
 }</code></pre>
</li>
</ul>
</td>
              </tr>
            </table>
          </section>
          <section id="registerShortcuts">
            <a name="//apple_ref/cpp/Method/registerShortcuts" class="dashAnchor"></a>
            <h5><a href="#registerShortcuts">registerShortcuts</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki:registerShortcuts(shortcuts[, override]) -&gt; table of registered shortcuts</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Method</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>Registers a list of shortcuts for one or more modes.</p>
<p>For each shortcut, the table structure matches the argument list for hotkey bindings in Hammerspoon: modifier keys list, key name, and event handler. An optional but recommended fourth item is a list with category and name of the shortcut to be displayed in the cheatsheet. For example, the following events open applications on keydown events on <kbd>s</kbd> and <kbd>⇧⌘s</kbd>:</p>
<p>An <a href="#Entity"><code>Entity</code></a> (or any subclassed Entity) instance can be also used as an event handler:</p>
<div class="highlight"><pre><span></span><span class="kd">local</span> <span class="n">shortcuts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">entity</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span> <span class="kc">nil</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">Ki</span><span class="p">.</span><span class="n">Application</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Microsoft Word&quot;</span><span class="p">),</span> <span class="p">{</span> <span class="s2">&quot;Entities&quot;</span><span class="p">,</span> <span class="s2">&quot;Microsoft Word&quot;</span> <span class="p">}</span> <span class="p">},</span>
        <span class="p">{</span> <span class="p">{</span> <span class="s2">&quot;cmd&quot;</span><span class="p">,</span> <span class="s2">&quot;shift&quot;</span> <span class="p">},</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">Ki</span><span class="p">.</span><span class="n">Application</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Slack&quot;</span><span class="p">),</span> <span class="p">{</span> <span class="s2">&quot;Entities&quot;</span><span class="p">,</span> <span class="s2">&quot;Slack&quot;</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">},</span>
    <span class="nb">select</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">{</span> <span class="kc">nil</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">Ki</span><span class="p">.</span><span class="n">Application</span><span class="p">:</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;Microsoft Word&quot;</span><span class="p">),</span> <span class="p">{</span> <span class="s2">&quot;Entities&quot;</span><span class="p">,</span> <span class="s2">&quot;Microsoft Word&quot;</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">},</span>
<span class="p">}</span>
</pre></div>
<p>The boolean return value of the event handler or an entity's <code>dispatchAction</code> function indicates whether to automatically exit back to <code>desktop</code> mode after the action has completed.</p>
<p>Parameters:</p>
<ul>
<li><code>shortcuts</code> - The list of shortcut objects</li>
<li><code>override</code> - A boolean denoting whether to override existing shortcuts</li>
</ul>
</td>
              </tr>
            </table>
          </section>
          <section id="start">
            <a name="//apple_ref/cpp/Method/start" class="dashAnchor"></a>
            <h5><a href="#start">start</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki:start() -&gt; hs.eventtap</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Method</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>Sets the status display, creates all transition and workflow events, and starts the event listener</p>
<p>Parameters:</p>
<ul>
<li>None</li>
</ul>
<p>Returns:</p>
<ul>
<li>An <a href="https://www.hammerspoon.org/docs/hs.eventtap.html"><code>hs.eventtap</code></a> object</li>
</ul>
</td>
              </tr>
            </table>
          </section>
          <section id="stop">
            <a name="//apple_ref/cpp/Method/stop" class="dashAnchor"></a>
            <h5><a href="#stop">stop</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki:stop() -&gt; hs.eventtap</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Method</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>Stops the event listener</p>
<p>Parameters:</p>
<ul>
<li>None</li>
</ul>
<p>Returns:</p>
<ul>
<li>An <a href="https://www.hammerspoon.org/docs/hs.eventtap.html"><code>hs.eventtap</code></a> object</li>
</ul>
</td>
              </tr>
            </table>
          </section>
          <section id="useDefaultConfig">
            <a name="//apple_ref/cpp/Method/useDefaultConfig" class="dashAnchor"></a>
            <h5><a href="#useDefaultConfig">useDefaultConfig</a></h5>
            <table>
              <tr>
                <th>Signature</th>
                <td><code>Ki:useDefaultConfig([options])</code></td>
              </tr>
              <tr>
                <th>Type</th>
                <td>Method</td>
              </tr>
              <tr>
                <th>Description</th>
                <td><p>Loads the default config</p>
<p>The default config initializes and assigns preset keybindings for (almost) all native macOS applications, common directory files, and popular websites, and achieves this by including the following preconfigured modes:</p>
<ul>
<li><code>URL</code> a mode in which URLs can be selected and opened</li>
<li><code>FILE</code> a mode in which files and directories can be automated</li>
<li><code>SELECT</code> the mode in which tabs or windows of entities can be selected</li>
<li><code>VOLUME</code> a mode in which the system volume can be set</li>
<li><code>BRIGHTNESS</code> a mode in which the system brightness can be set</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>options</code> - A table containing options that configures which default configs to load<ul>
<li><code>include</code> - A list of entity filenames to load, in which all unspecified entities will not be loaded</li>
<li><code>exclude</code> - A list of entity filenames to exclude from loading, in which all unspecified filenames will be loaded</li>
</ul>
</li>
</ul>
</td>
              </tr>
            </table>
          </section>
  </body>
</html>